

 1. Accident Analysis by Year and Area


 
        SELECT 
            COALESCE(CONVERT(VARCHAR, DD.Year), 'All Years') AS Year,
            COALESCE(LD.Urban_or_Rural_Area, 'All Areas') AS Area,
            COUNT(AVF.Accident_Index) AS Total_Accidents,
            AVG(AVF.Number_of_Casualties) AS Avg_Casualties
        FROM 
            AccidentVehicleFact AVF
        JOIN 
            DateDimension DD ON AVF.Date_ID = DD.Date_ID
        JOIN 
            LocationDimension LD ON AVF.Location_ID = LD.Location_ID
        GROUP BY 
            ROLLUP (DD.Year, LD.Urban_or_Rural_Area)
        ORDER BY 
            DD.Year, LD.Urban_or_Rural_Area;
    


 +----+-----------+-------------+-------------------+------------------+
|    | Year      | Area        |   Total_Accidents |   Avg_Casualties |
+====+===========+=============+===================+==================+
|  0 | All Years | All Areas   |            203644 |                1 |
+----+-----------+-------------+-------------------+------------------+
|  1 | 2005      | All Areas   |             13707 |                1 |
+----+-----------+-------------+-------------------+------------------+
|  2 | 2005      | Rural       |              5223 |                1 |
+----+-----------+-------------+-------------------+------------------+
|  3 | 2005      | Unallocated |                 6 |                1 |
+----+-----------+-------------+-------------------+------------------+
|  4 | 2005      | Urban       |              8478 |                1 |
+----+-----------+-------------+-------------------+------------------+
|  5 | 2006      | All Areas   |             13974 |                1 |
+----+-----------+-------------+-------------------+------------------+
|  6 | 2006      | Rural       |              5204 |                1 |
+----+-----------+-------------+-------------------+------------------+
|  7 | 2006      | Unallocated |                 3 |                1 |
+----+-----------+-------------+-------------------+------------------+
|  8 | 2006      | Urban       |              8767 |                1 |
+----+-----------+-------------+-------------------+------------------+
|  9 | 2007      | All Areas   |             14941 |                1 |
+----+-----------+-------------+-------------------+------------------+
| 10 | 2007      | Rural       |              5694 |                1 |
+----+-----------+-------------+-------------------+------------------+
| 11 | 2007      | Urban       |              9247 |                1 |
+----+-----------+-------------+-------------------+------------------+
| 12 | 2008      | All Areas   |             14138 |                1 |
+----+-----------+-------------+-------------------+------------------+
| 13 | 2008      | Rural       |              5201 |                1 |
+----+-----------+-------------+-------------------+------------------+
| 14 | 2008      | Urban       |              8937 |                1 |
+----+-----------+-------------+-------------------+------------------+
| 15 | 2009      | All Areas   |             18578 |                1 |
+----+-----------+-------------+-------------------+------------------+
| 16 | 2009      | Rural       |              6959 |                1 |
+----+-----------+-------------+-------------------+------------------+
| 17 | 2009      | Urban       |             11619 |                1 |
+----+-----------+-------------+-------------------+------------------+
| 18 | 2010      | All Areas   |             18172 |                1 |
+----+-----------+-------------+-------------------+------------------+
| 19 | 2010      | Rural       |              6758 |                1 |
+----+-----------+-------------+-------------------+------------------+
| 20 | 2010      | Urban       |             11414 |                1 |
+----+-----------+-------------+-------------------+------------------+
| 21 | 2011      | All Areas   |             18105 |                1 |
+----+-----------+-------------+-------------------+------------------+
| 22 | 2011      | Rural       |              6422 |                1 |
+----+-----------+-------------+-------------------+------------------+
| 23 | 2011      | Urban       |             11683 |                1 |
+----+-----------+-------------+-------------------+------------------+
| 24 | 2012      | All Areas   |             17111 |                1 |
+----+-----------+-------------+-------------------+------------------+
| 25 | 2012      | Rural       |              6156 |                1 |
+----+-----------+-------------+-------------------+------------------+
| 26 | 2012      | Urban       |             10955 |                1 |
+----+-----------+-------------+-------------------+------------------+
| 27 | 2013      | All Areas   |             16612 |                1 |
+----+-----------+-------------+-------------------+------------------+
| 28 | 2013      | Rural       |              6007 |                1 |
+----+-----------+-------------+-------------------+------------------+
| 29 | 2013      | Urban       |             10605 |                1 |
+----+-----------+-------------+-------------------+------------------+
| 30 | 2014      | All Areas   |             17763 |                1 |
+----+-----------+-------------+-------------------+------------------+
| 31 | 2014      | Rural       |              6159 |                1 |
+----+-----------+-------------+-------------------+------------------+
| 32 | 2014      | Urban       |             11604 |                1 |
+----+-----------+-------------+-------------------+------------------+
| 33 | 2015      | All Areas   |             20590 |                1 |
+----+-----------+-------------+-------------------+------------------+
| 34 | 2015      | Rural       |              7005 |                1 |
+----+-----------+-------------+-------------------+------------------+
| 35 | 2015      | Urban       |             13585 |                1 |
+----+-----------+-------------+-------------------+------------------+
| 36 | 2016      | All Areas   |             19953 |                1 |
+----+-----------+-------------+-------------------+------------------+
| 37 | 2016      | Rural       |              6979 |                1 |
+----+-----------+-------------+-------------------+------------------+
| 38 | 2016      | Unallocated |                 1 |                3 |
+----+-----------+-------------+-------------------+------------------+
| 39 | 2016      | Urban       |             12973 |                1 |
+----+-----------+-------------+-------------------+------------------+


 2. Accident Counts by Vehicle Type in Rural Areas


 
        SELECT 
            DD.Year,
            VD.Vehicle_Type,
            COUNT(AVF.Accident_Index) AS Total_Accidents
        FROM 
            AccidentVehicleFact AVF
        JOIN 
            VehicleDimension VD ON AVF.Vehicle_ID = VD.Vehicle_ID
        JOIN 
            DateDimension DD ON AVF.Date_ID = DD.Date_ID
        JOIN 
            LocationDimension LD ON AVF.Location_ID = LD.Location_ID
        WHERE 
            VD.Vehicle_Type IN ('Car', 'Truck') AND LD.Urban_or_Rural_Area = 'Rural'
        GROUP BY 
            DD.Year, VD.Vehicle_Type
        ORDER BY 
            DD.Year, VD.Vehicle_Type;
    


 +----+--------+----------------+-------------------+
|    |   Year | Vehicle_Type   |   Total_Accidents |
+====+========+================+===================+
|  0 |   2005 | Car            |              3716 |
+----+--------+----------------+-------------------+
|  1 |   2006 | Car            |              3632 |
+----+--------+----------------+-------------------+
|  2 |   2007 | Car            |              4151 |
+----+--------+----------------+-------------------+
|  3 |   2008 | Car            |              3757 |
+----+--------+----------------+-------------------+
|  4 |   2009 | Car            |              5087 |
+----+--------+----------------+-------------------+
|  5 |   2010 | Car            |              5089 |
+----+--------+----------------+-------------------+
|  6 |   2011 | Car            |              4744 |
+----+--------+----------------+-------------------+
|  7 |   2012 | Car            |              4888 |
+----+--------+----------------+-------------------+
|  8 |   2013 | Car            |              4711 |
+----+--------+----------------+-------------------+
|  9 |   2014 | Car            |              4738 |
+----+--------+----------------+-------------------+
| 10 |   2015 | Car            |              5543 |
+----+--------+----------------+-------------------+
| 11 |   2016 | Car            |              5336 |
+----+--------+----------------+-------------------+


 3. Weekly Accident Trends


 
        SELECT 
            Year,
            SUM(CASE WHEN Day_of_Week = 'Monday' THEN 1 ELSE 0 END) AS Monday,
            SUM(CASE WHEN Day_of_Week = 'Tuesday' THEN 1 ELSE 0 END) AS Tuesday,
            SUM(CASE WHEN Day_of_Week = 'Wednesday' THEN 1 ELSE 0 END) AS Wednesday,
            SUM(CASE WHEN Day_of_Week = 'Thursday' THEN 1 ELSE 0 END) AS Thursday,
            SUM(CASE WHEN Day_of_Week = 'Friday' THEN 1 ELSE 0 END) AS Friday,
            SUM(CASE WHEN Day_of_Week = 'Saturday' THEN 1 ELSE 0 END) AS Saturday,
            SUM(CASE WHEN Day_of_Week = 'Sunday' THEN 1 ELSE 0 END) AS Sunday
        FROM 
            (SELECT 
                DD.Year,
                DD.Day_of_Week,
                AVF.Accident_Index
            FROM 
                AccidentVehicleFact AVF
            JOIN 
                DateDimension DD ON AVF.Date_ID = DD.Date_ID) AS SubQuery
        GROUP BY 
            Year
        ORDER BY 
            Year;
    


 +----+--------+----------+-----------+-------------+------------+----------+------------+----------+
|    |   Year |   Monday |   Tuesday |   Wednesday |   Thursday |   Friday |   Saturday |   Sunday |
+====+========+==========+===========+=============+============+==========+============+==========+
|  0 |   2005 |     1978 |      2067 |        2161 |       2115 |     2291 |       1740 |     1355 |
+----+--------+----------+-----------+-------------+------------+----------+------------+----------+
|  1 |   2006 |     1920 |      2048 |        2174 |       2104 |     2411 |       1781 |     1536 |
+----+--------+----------+-----------+-------------+------------+----------+------------+----------+
|  2 |   2007 |     2208 |      2253 |        2247 |       2324 |     2417 |       1895 |     1597 |
+----+--------+----------+-----------+-------------+------------+----------+------------+----------+
|  3 |   2008 |     2035 |      2235 |        2176 |       2077 |     2252 |       1865 |     1498 |
+----+--------+----------+-----------+-------------+------------+----------+------------+----------+
|  4 |   2009 |     2587 |      2805 |        2817 |       2754 |     3092 |       2472 |     2051 |
+----+--------+----------+-----------+-------------+------------+----------+------------+----------+
|  5 |   2010 |     2620 |      2737 |        2657 |       2782 |     2986 |       2452 |     1938 |
+----+--------+----------+-----------+-------------+------------+----------+------------+----------+
|  6 |   2011 |     2529 |      2702 |        2769 |       2833 |     3016 |       2310 |     1946 |
+----+--------+----------+-----------+-------------+------------+----------+------------+----------+
|  7 |   2012 |     2412 |      2554 |        2667 |       2616 |     2818 |       2191 |     1853 |
+----+--------+----------+-----------+-------------+------------+----------+------------+----------+
|  8 |   2013 |     2333 |      2551 |        2425 |       2552 |     2843 |       2145 |     1763 |
+----+--------+----------+-----------+-------------+------------+----------+------------+----------+
|  9 |   2014 |     2639 |      2711 |        2638 |       2608 |     2895 |       2369 |     1903 |
+----+--------+----------+-----------+-------------+------------+----------+------------+----------+
| 10 |   2015 |     2999 |      3161 |        3143 |       3141 |     3254 |       2700 |     2192 |
+----+--------+----------+-----------+-------------+------------+----------+------------+----------+
| 11 |   2016 |     2753 |      2866 |        3039 |       3095 |     3277 |       2674 |     2249 |
+----+--------+----------+-----------+-------------+------------+----------+------------+----------+


 4. Accidents by Driver Age and Vehicle Type


 
        SELECT 
            DD2.Age_Band_of_Driver,
            VD.Vehicle_Type,
            COUNT(AVF.Accident_Index) AS Total_Accidents,
            AVG(AVF.Number_of_Casualties) AS Avg_Casualties
        FROM 
            AccidentVehicleFact AVF
        JOIN 
            DriversDimension DD2 ON AVF.Driver_ID = DD2.Driver_ID
        JOIN 
            VehicleDimension VD ON AVF.Vehicle_ID = VD.Vehicle_ID
        GROUP BY 
            DD2.Age_Band_of_Driver, VD.Vehicle_Type
        ORDER BY 
            Total_Accidents DESC;
    


 +-----+------------------------------+---------------------------------------+-------------------+------------------+
|     | Age_Band_of_Driver           | Vehicle_Type                          |   Total_Accidents |   Avg_Casualties |
+=====+==============================+=======================================+===================+==================+
|   0 | 26 - 35                      | Car                                   |             47415 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|   1 | 36 - 45                      | Car                                   |             45662 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|   2 | 46 - 55                      | Car                                   |             36677 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|   3 | 21 - 25                      | Car                                   |             25127 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|   4 | 56 - 65                      | Car                                   |             21855 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|   5 | 16 - 20                      | Car                                   |             18382 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|   6 | Data missing or out of range | Car                                   |             18319 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|   7 | 66 - 75                      | Car                                   |              9686 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|   8 | Over 75                      | Car                                   |              5822 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|   9 | 26 - 35                      | Van / Goods 3.5 tonnes mgw or under   |              3424 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  10 | 36 - 45                      | Van / Goods 3.5 tonnes mgw or under   |              3358 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  11 | 46 - 55                      | Van / Goods 3.5 tonnes mgw or under   |              2648 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  12 | 26 - 35                      | Motorcycle over 500cc                 |              2239 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  13 | 36 - 45                      | Motorcycle over 500cc                 |              2199 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  14 | 26 - 35                      | Bus or coach (17 or more pass seats)  |              1990 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  15 | 36 - 45                      | Bus or coach (17 or more pass seats)  |              1936 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  16 | 21 - 25                      | Van / Goods 3.5 tonnes mgw or under   |              1885 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  17 | 26 - 35                      | Goods 7.5 tonnes mgw and over         |              1764 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  18 | 46 - 55                      | Motorcycle over 500cc                 |              1757 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  19 | 36 - 45                      | Goods 7.5 tonnes mgw and over         |              1711 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  20 | 56 - 65                      | Van / Goods 3.5 tonnes mgw or under   |              1600 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  21 | 46 - 55                      | Bus or coach (17 or more pass seats)  |              1557 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  22 | 26 - 35                      | Motorcycle 125cc and under            |              1441 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  23 | 46 - 55                      | Goods 7.5 tonnes mgw and over         |              1425 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  24 | 36 - 45                      | Motorcycle 125cc and under            |              1419 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  25 | 16 - 20                      | Van / Goods 3.5 tonnes mgw or under   |              1398 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  26 | Data missing or out of range | Van / Goods 3.5 tonnes mgw or under   |              1386 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  27 | 21 - 25                      | Motorcycle over 500cc                 |              1239 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  28 | 26 - 35                      | Taxi/Private hire car                 |              1184 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  29 | 46 - 55                      | Motorcycle 125cc and under            |              1155 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  30 | 56 - 65                      | Motorcycle over 500cc                 |              1116 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  31 | 36 - 45                      | Taxi/Private hire car                 |              1065 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  32 | 21 - 25                      | Bus or coach (17 or more pass seats)  |              1053 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  33 | 46 - 55                      | Taxi/Private hire car                 |               960 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  34 | 56 - 65                      | Bus or coach (17 or more pass seats)  |               920 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  35 | 21 - 25                      | Goods 7.5 tonnes mgw and over         |               894 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  36 | Data missing or out of range | Motorcycle over 500cc                 |               887 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  37 | 16 - 20                      | Motorcycle over 500cc                 |               869 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  38 | 56 - 65                      | Goods 7.5 tonnes mgw and over         |               818 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  39 | 16 - 20                      | Bus or coach (17 or more pass seats)  |               802 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  40 | 21 - 25                      | Motorcycle 125cc and under            |               788 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  41 | 16 - 20                      | Goods 7.5 tonnes mgw and over         |               763 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  42 | 66 - 75                      | Van / Goods 3.5 tonnes mgw or under   |               720 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  43 | Data missing or out of range | Bus or coach (17 or more pass seats)  |               718 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  44 | 26 - 35                      | Motorcycle over 125cc and up to 500cc |               665 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  45 | 56 - 65                      | Motorcycle 125cc and under            |               661 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  46 | 36 - 45                      | Motorcycle over 125cc and up to 500cc |               646 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  47 | 36 - 45                      | Goods over 3.5t. and under 7.5t       |               637 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  48 | 26 - 35                      | Motorcycle 50cc and under             |               636 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  49 | 21 - 25                      | Taxi/Private hire car                 |               624 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  50 | 26 - 35                      | Goods over 3.5t. and under 7.5t       |               624 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  51 | Data missing or out of range | Goods 7.5 tonnes mgw and over         |               610 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  52 | 36 - 45                      | Motorcycle 50cc and under             |               606 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  53 | 56 - 65                      | Taxi/Private hire car                 |               591 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  54 | 16 - 20                      | Motorcycle 125cc and under            |               582 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  55 | Data missing or out of range | Motorcycle 125cc and under            |               552 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  56 | 46 - 55                      | Motorcycle over 125cc and up to 500cc |               514 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  57 | 46 - 55                      | Goods over 3.5t. and under 7.5t       |               509 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  58 | 16 - 20                      | Taxi/Private hire car                 |               486 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  59 | 46 - 55                      | Motorcycle 50cc and under             |               484 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  60 | 11 - 15                      | Car                                   |               464 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  61 | Data missing or out of range | Taxi/Private hire car                 |               452 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  62 | Over 75                      | Van / Goods 3.5 tonnes mgw or under   |               442 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  63 | 66 - 75                      | Motorcycle over 500cc                 |               423 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  64 | 36 - 45                      | Other vehicle                         |               422 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  65 | 26 - 35                      | Other vehicle                         |               412 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  66 | 66 - 75                      | Bus or coach (17 or more pass seats)  |               388 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  67 | 66 - 75                      | Goods 7.5 tonnes mgw and over         |               375 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  68 | 46 - 55                      | Other vehicle                         |               363 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  69 | 21 - 25                      | Motorcycle over 125cc and up to 500cc |               345 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  70 | 21 - 25                      | Motorcycle 50cc and under             |               344 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  71 | 21 - 25                      | Goods over 3.5t. and under 7.5t       |               321 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  72 | 56 - 65                      | Motorcycle over 125cc and up to 500cc |               317 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  73 | 66 - 75                      | Motorcycle 125cc and under            |               309 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  74 | Over 75                      | Motorcycle over 500cc                 |               304 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  75 | 56 - 65                      | Goods over 3.5t. and under 7.5t       |               290 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  76 | 56 - 65                      | Motorcycle 50cc and under             |               276 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  77 | Data missing or out of range | Motorcycle over 125cc and up to 500cc |               252 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  78 | 66 - 75                      | Taxi/Private hire car                 |               251 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  79 | Over 75                      | Bus or coach (17 or more pass seats)  |               250 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  80 | 16 - 20                      | Motorcycle 50cc and under             |               249 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  81 | Data missing or out of range | Motorcycle 50cc and under             |               236 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  82 | Data missing or out of range | Goods over 3.5t. and under 7.5t       |               234 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  83 | 16 - 20                      | Motorcycle over 125cc and up to 500cc |               219 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  84 | 21 - 25                      | Other vehicle                         |               213 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  85 | 16 - 20                      | Goods over 3.5t. and under 7.5t       |               209 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  86 | Over 75                      | Motorcycle 125cc and under            |               208 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  87 | 26 - 35                      | Minibus (8 - 16 passenger seats)      |               204 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  88 | 56 - 65                      | Other vehicle                         |               189 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  89 | Over 75                      | Goods 7.5 tonnes mgw and over         |               187 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  90 | 36 - 45                      | Minibus (8 - 16 passenger seats)      |               181 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  91 | 26 - 35                      | Agricultural vehicle                  |               175 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  92 | Data missing or out of range | Other vehicle                         |               166 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  93 | 36 - 45                      | Agricultural vehicle                  |               157 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  94 | Over 75                      | Taxi/Private hire car                 |               156 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  95 | 16 - 20                      | Other vehicle                         |               151 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  96 | 46 - 55                      | Minibus (8 - 16 passenger seats)      |               145 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  97 | 46 - 55                      | Agricultural vehicle                  |               143 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  98 | 66 - 75                      | Motorcycle over 125cc and up to 500cc |               122 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
|  99 | 66 - 75                      | Goods over 3.5t. and under 7.5t       |               122 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 100 | 66 - 75                      | Motorcycle 50cc and under             |               119 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 101 | 21 - 25                      | Agricultural vehicle                  |                99 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 102 | Data missing or out of range | Agricultural vehicle                  |                91 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 103 | 21 - 25                      | Minibus (8 - 16 passenger seats)      |                91 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 104 | 66 - 75                      | Other vehicle                         |                85 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 105 | 56 - 65                      | Agricultural vehicle                  |                83 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 106 | Over 75                      | Motorcycle 50cc and under             |                78 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 107 | 6 - 10                       | Car                                   |                77 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 108 | 56 - 65                      | Minibus (8 - 16 passenger seats)      |                76 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 109 | 16 - 20                      | Agricultural vehicle                  |                76 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 110 | Over 75                      | Motorcycle over 125cc and up to 500cc |                73 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 111 | Over 75                      | Goods over 3.5t. and under 7.5t       |                72 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 112 | 16 - 20                      | Minibus (8 - 16 passenger seats)      |                65 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 113 | Data missing or out of range | Minibus (8 - 16 passenger seats)      |                63 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 114 | Over 75                      | Other vehicle                         |                48 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 115 | 66 - 75                      | Agricultural vehicle                  |                40 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 116 | 66 - 75                      | Minibus (8 - 16 passenger seats)      |                39 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 117 | 11 - 15                      | Van / Goods 3.5 tonnes mgw or under   |                31 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 118 | Over 75                      | Agricultural vehicle                  |                22 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 119 | 11 - 15                      | Motorcycle over 500cc                 |                18 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 120 | 11 - 15                      | Bus or coach (17 or more pass seats)  |                17 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 121 | Over 75                      | Minibus (8 - 16 passenger seats)      |                15 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 122 | 26 - 35                      | Pedal cycle                           |                14 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 123 | 46 - 55                      | Pedal cycle                           |                11 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 124 | 11 - 15                      | Motorcycle 125cc and under            |                11 |              nan |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 125 | 11 - 15                      | Taxi/Private hire car                 |                11 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 126 | 36 - 45                      | Pedal cycle                           |                11 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 127 | 11 - 15                      | Goods 7.5 tonnes mgw and over         |                10 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 128 | 0 - 5                        | Car                                   |                 9 |              nan |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 129 | 6 - 10                       | Van / Goods 3.5 tonnes mgw or under   |                 8 |              nan |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 130 | 11 - 15                      | Goods over 3.5t. and under 7.5t       |                 7 |                5 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 131 | 11 - 15                      | Motorcycle 50cc and under             |                 7 |                4 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 132 | 21 - 25                      | Pedal cycle                           |                 6 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 133 | 11 - 15                      | Motorcycle over 125cc and up to 500cc |                 6 |              nan |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 134 | Data missing or out of range | Pedal cycle                           |                 5 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 135 | 6 - 10                       | Motorcycle 125cc and under            |                 5 |              nan |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 136 | 66 - 75                      | Pedal cycle                           |                 5 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 137 | 11 - 15                      | Other vehicle                         |                 4 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 138 | 11 - 15                      | Minibus (8 - 16 passenger seats)      |                 3 |              nan |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 139 | 6 - 10                       | Goods over 3.5t. and under 7.5t       |                 3 |              nan |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 140 | 11 - 15                      | Agricultural vehicle                  |                 3 |                2 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 141 | Over 75                      | Pedal cycle                           |                 3 |              nan |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 142 | 6 - 10                       | Bus or coach (17 or more pass seats)  |                 3 |              nan |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 143 | 56 - 65                      | Pedal cycle                           |                 2 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 144 | 6 - 10                       | Taxi/Private hire car                 |                 2 |              nan |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 145 | 0 - 5                        | Goods 7.5 tonnes mgw and over         |                 2 |              nan |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 146 | 6 - 10                       | Motorcycle over 500cc                 |                 2 |              nan |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 147 | 6 - 10                       | Minibus (8 - 16 passenger seats)      |                 2 |              nan |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 148 | 6 - 10                       | Other vehicle                         |                 2 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 149 | 6 - 10                       | Goods 7.5 tonnes mgw and over         |                 1 |              nan |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 150 | 6 - 10                       | Agricultural vehicle                  |                 1 |              nan |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 151 | 6 - 10                       | Motorcycle 50cc and under             |                 1 |              nan |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 152 | Over 75                      | Ridden horse                          |                 1 |                2 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 153 | 0 - 5                        | Bus or coach (17 or more pass seats)  |                 1 |              nan |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 154 | 0 - 5                        | Van / Goods 3.5 tonnes mgw or under   |                 1 |              nan |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 155 | 0 - 5                        | Taxi/Private hire car                 |                 1 |              nan |
+-----+------------------------------+---------------------------------------+-------------------+------------------+
| 156 | 46 - 55                      | Data missing or out of range          |                 1 |                1 |
+-----+------------------------------+---------------------------------------+-------------------+------------------+


 5. Top Districts by Casualties


 
        SELECT TOP 10
            COALESCE(LD.Local_Authority_District, 'Total') AS District,
            COALESCE(LD.Urban_or_Rural_Area, 'All Areas') AS Area_Type,
            SUM(AVF.Number_of_Casualties) AS Total_Casualties
        FROM 
            AccidentVehicleFact AVF
        JOIN 
            LocationDimension LD ON AVF.Location_ID = LD.Location_ID
        GROUP BY 
            ROLLUP (LD.Local_Authority_District, LD.Urban_or_Rural_Area)
        ORDER BY 
            Total_Casualties DESC;
    


 +----+------------+-------------+--------------------+
|    | District   | Area_Type   |   Total_Casualties |
+====+============+=============+====================+
|  0 | Total      | All Areas   |             281244 |
+----+------------+-------------+--------------------+
|  1 | Birmingham | All Areas   |               5442 |
+----+------------+-------------+--------------------+
|  2 | Birmingham | Urban       |               5353 |
+----+------------+-------------+--------------------+
|  3 | Leeds      | All Areas   |               3921 |
+----+------------+-------------+--------------------+
|  4 | Leeds      | Urban       |               3109 |
+----+------------+-------------+--------------------+
|  5 | Bradford   | All Areas   |               2817 |
+----+------------+-------------+--------------------+
|  6 | Liverpool  | All Areas   |               2766 |
+----+------------+-------------+--------------------+
|  7 | Liverpool  | Urban       |               2714 |
+----+------------+-------------+--------------------+
|  8 | Manchester | All Areas   |               2536 |
+----+------------+-------------+--------------------+
|  9 | Manchester | Urban       |               2488 |
+----+------------+-------------+--------------------+


 6. High Accident Dates by Year


 
        SELECT TOP 10
            DD.Year,
            COALESCE(CONVERT(VARCHAR, DD.Date), 'Year Total') AS Date,
            COUNT(AVF.Accident_Index) AS Total_Accidents
        FROM 
            AccidentVehicleFact AVF
        JOIN 
            DateDimension DD ON AVF.Date_ID = DD.Date_ID
        GROUP BY 
            CUBE (DD.Year, DD.Date)
        ORDER BY 
            Total_Accidents DESC;
    


 +----+--------+------------+-------------------+
|    |   Year | Date       |   Total_Accidents |
+====+========+============+===================+
|  0 |    nan | Year Total |            203644 |
+----+--------+------------+-------------------+
|  1 |   2015 | Year Total |             20590 |
+----+--------+------------+-------------------+
|  2 |   2016 | Year Total |             19953 |
+----+--------+------------+-------------------+
|  3 |   2009 | Year Total |             18578 |
+----+--------+------------+-------------------+
|  4 |   2010 | Year Total |             18172 |
+----+--------+------------+-------------------+
|  5 |   2011 | Year Total |             18105 |
+----+--------+------------+-------------------+
|  6 |   2014 | Year Total |             17763 |
+----+--------+------------+-------------------+
|  7 |   2012 | Year Total |             17111 |
+----+--------+------------+-------------------+
|  8 |   2013 | Year Total |             16612 |
+----+--------+------------+-------------------+
|  9 |   2007 | Year Total |             14941 |
+----+--------+------------+-------------------+


 7. Accidents by Weather and Road Conditions


 
        SELECT TOP 10
            RCD.Weather_Conditions,
            RCD.Road_Surface_Conditions,
            COUNT(AVF.Accident_Index) AS Total_Accidents
        FROM 
            AccidentVehicleFact AVF
        JOIN 
            RoadConditionDimension RCD ON AVF.Location_ID = RCD.RoadCondition_ID
        GROUP BY 
            RCD.Weather_Conditions, RCD.Road_Surface_Conditions
        ORDER BY 
            Total_Accidents DESC;
    


 +----+-----------------------+---------------------------+-------------------+
|    | Weather_Conditions    | Road_Surface_Conditions   |   Total_Accidents |
+====+=======================+===========================+===================+
|  0 | Fine no high winds    | Dry                       |            135849 |
+----+-----------------------+---------------------------+-------------------+
|  1 | Fine no high winds    | Wet or damp               |             25243 |
+----+-----------------------+---------------------------+-------------------+
|  2 | Raining no high winds | Wet or damp               |             23337 |
+----+-----------------------+---------------------------+-------------------+
|  3 | Unknown               | Dry                       |              2824 |
+----+-----------------------+---------------------------+-------------------+
|  4 | Raining + high winds  | Wet or damp               |              2681 |
+----+-----------------------+---------------------------+-------------------+
|  5 | Other                 | Wet or damp               |              2457 |
+----+-----------------------+---------------------------+-------------------+
|  6 | Fine no high winds    | Frost or ice              |              2365 |
+----+-----------------------+---------------------------+-------------------+
|  7 | Fine + high winds     | Dry                       |              1480 |
+----+-----------------------+---------------------------+-------------------+
|  8 | Fine + high winds     | Wet or damp               |               979 |
+----+-----------------------+---------------------------+-------------------+
|  9 | Other                 | Frost or ice              |               921 |
+----+-----------------------+---------------------------+-------------------+
